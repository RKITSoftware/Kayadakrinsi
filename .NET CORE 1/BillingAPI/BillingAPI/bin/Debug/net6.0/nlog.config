<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/201/XMLSchema-instance"
	  autoReload="true"
      internalLogLevel="Information"
      internalLogFile="${currentdir}\Log\internallog.txt"
	  throwExceptions="true">

	<extensions>
		<add assembly="NLog.Web.AspNetCore" />
		<add assembly="NLog.Database"/>

	</extensions>

	<targets>

		<!--Logs into the target file-->

		<target name="Trace" xsi:type="File"
				fileName="${currentdir}\Log\Trace\${date:format=dd-MM-yyyy}.txt"
				layout="${longdate} | ${level:uppercase=true} | ${logger} | ${message}"/>

		<target name="Model" xsi:type="File"
						fileName="${currentdir}\Log\Model\${date:format=dd-MM-yyyy}.txt"
						layout="${longdate} | ${level:uppercase=true} | ${logger} | ${message}"/>

		<target name="Information" xsi:type="File"
				fileName="${currentdir}\Log\Information\${date:format=dd-MM-yyyy}.txt"
				layout="${longdate} | ${level:uppercase=true} | ${logger} | ${message}"/>

		<target name="Warning" xsi:type="File"
					fileName="${currentdir}\Log\Warning\${date:format=dd-MM-yyyy}.txt"
					layout="${longdate} | ${level:uppercase=true} | ${logger} | ${message}"/>

		<target name="Error" xsi:type="File"
					fileName="${currentdir}\Log\Error\${date:format=dd-MM-yyyy}.txt"
					layout="${longdate} | ${level:uppercase=true} | ${logger} | ${message}"/>

		<target name="Critical" xsi:type="File"
					fileName="${currentdir}\Log\Critical\${date:format=dd-MM-yyyy}.txt"
					layout="${longdate} | ${level:uppercase=true} | ${logger} | ${message}"/>

		<target name="Debug" xsi:type="File"
					fileName="${currentdir}\Log\Debug\${date:format=dd-MM-yyyy}.txt"
					layout="${longdate} | ${level:uppercase=true} | ${logger} | ${message}"/>

		<!--Logs into the target database table-->

		<target name="database" xsi:type="Database"
              dbProvider="MySql.Data.MySqlClient.MySqlConnection, MySql.Data"
              connectionString="server=localhost;Database=nlogDemo;user id=Admin;password=gs@123;SslMode=none"
				commandText="insert into nlogDemo.log01 (logged,log_level,logger,message) values (@logged, @level, @logger, @message);">

			<parameter name="@logged" layout="${date}" />
			<parameter name="@level" layout="${level}" />
			<parameter name="@message" layout="${message}" />
			<parameter name="@logger" layout="${logger}" />

		</target>

		<target name="databaseLog" xsi:type="Database"
              dbProvider="MySql.Data.MySqlClient.MySqlConnection, MySql.Data"
              connectionString="server=localhost;Database=nlogDemo;user id=Admin;password=gs@123;SslMode=none"
				commandText="insert into nlogDemo.log02 (Application, Logged, LogLevel, Message, Logger, CallSite, Exception) values (@application, @logged, @level, @message, @logger, @callsite, @exception);">

			<parameter name="@application" layout="Billing" />
			<parameter name="@logged" layout="${date}" />
			<parameter name="@level" layout="${level}" />
			<parameter name="@message" layout="${message}" />
			<parameter name="@logger" layout="${logger}" />
			<parameter name="@callSite" layout="${callsite:filename=true}" />
			<parameter name="@exception" layout="${exception:tostring}" />

		</target>

		<!--EventLog target Application-->
		<!--<target xsi:type="EventLog" name="eventlog" source="MyWebApi" log="Application" />-->

	</targets>

	<rules>
		<logger name="*" levels="Trace" writeTo="Trace" />
		<logger name="*" minlevel="Info" writeTo="Model">
			<filters>
				<when condition="contains('${message}', 'Model : ')" action="Log" />
				<when condition="not contains('${message}', 'Model : ')" action="Ignore" />
			</filters>
		</logger>
		<logger name="*" levels="Info" writeTo="Information" />
		<logger name="*" levels="Warn" writeTo="Warning,databaseLog,database" />
		<logger name="*" levels="Error" writeTo="Error,databaseLog,database" />
		<logger name="*" levels="Fatal" writeTo="Critical" />
		<logger name="*" levels="Debug" writeTo="Debug" />
	</rules>

</nlog>