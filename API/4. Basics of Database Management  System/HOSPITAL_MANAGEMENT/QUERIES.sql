-- JOIN, LIMIT, ORDER BY
SELECT 
	D01.D01F01 AS RECORD_ID,
    P.N01F02 AS PATIENT_NAME,
    D.F01F02 AS DOCTOR_NAME,
    DI.S01F02 AS DIEASES_NAME,
    H.F02F02 AS HELPER_NAME,
    C.G01F04 AS CHARGE
FROM
	RCD01 R JOIN PTN01 P
ON 
	R.D01F02 = P.N01F01
JOIN 
	STF01 D 
ON
	R.D01F03 = D.F01F01
JOIN
	STF02 H
ON
	R.D01F04 = H.F02F01
JOIN
	DIS01 DI 
ON 
	R.D01F05 = S01F01
JOIN
	CHRG01 C 
ON
	R.D01F06 = C.G01F01
ORDER BY 
	CHARGE
LIMIT 2,5;
    
-- CREATE VIEW
CREATE OR REPLACE VIEW 
	`VWS_RCD01` 
AS
SELECT 
	R.D01F01 AS RECORD_ID,
    P.N01F02 AS PATIENT_NAME,
    D.F01F02 AS DOCTOR_NAME,
    DI.S01F02 AS DIEASES_NAME,
    H.F02F02 AS HELPER_NAME,
    C.G01F04 AS CHARGE
FROM
	RCD01 R,
    PTN01 P,
    STF01 D,
    STF02 H,
    DIS01 DI,
    CHRG01 C 
WHERE 
	R.D01F02 = P.N01F01 
AND 
	R.D01F03 = D.F01F01 
AND 
	R.D01F03 = D.F01F01 
AND 
	R.D01F04 = H.F02F01 
AND 
	R.D01F05 = S01F01 
AND 
	R.D01F06 = C.G01F01;

-- SELECT FROM VIEW IN DESCENDING ORDER
SELECT 
	RECORD_ID,
    PATIENT_NAME,
    DOCTOR_NAME,
    DIEASES_NAME,
    HELPER_NAME,
    CHARGE
FROM 
	`RECORDS`
ORDER BY 
	PATIENT_NAME 
DESC;

-- EXPLAIN
EXPLAIN SELECT 
	RECORD_ID,
    PATIENT_NAME,
    DOCTOR_NAME,
    DIEASES_NAME,
    HELPER_NAME,
    CHARGE
FROM 
	`RECORDS`
ORDER BY 
	PATIENT_NAME 
DESC;

-- COUNT, SUB-QUERY
SELECT 
	COUNT(D01F01)
FROM 
	RCD01 
WHERE 
	D01F02 
IN 
	(SELECT N01F01 FROM PTN01 WHERE N01F02 LIKE "_I%");

-- UNION WITH DIFFERENT COLUMNS
SELECT 
	D01F01 AS RECORD_ID,
    D01F07 AS ADMITING_DATE,
    D01F08 AS DISCHARGE_DATE
FROM
	RCD01
UNION
SELECT
	N01F02
FROM
	PTN01
WHERE 
	N01F01
IN
	(SELECT D01F02 FROM RCD01);
  
-- UNION WITH SAME COLUMN
SELECT 
	D01F02
FROM 
	RCD01
UNION
SELECT 
	N01F01
FROM
	PTN01;
    
CREATE UNIQUE INDEX
	IND01
ON 
	RCD01(D01F01);
    
SHOW INDEX FROM
	RCD01;
    
