-- DB : inventory

-- SUBQUERY WITH THE SELECT 
	CREATE TABLE  CUS02(
	   S02F01 INT NOT NULL PRIMARY KEY COMMENT 'CUSTOMER ID',
	   S02F02 VARCHAR(20) NOT NULL COMMENT 'CUSTOMER NAME',
	   S02F03 INT NOT NULL COMMENT 'CUSTOMER AGE',
	   S02F04 CHAR (25) COMMENT 'CUSTOMER ADDRESS',
	   S02F05 DECIMAL (18, 2) COMMENT 'CUSTOMER SALARY' 
	);

	INSERT INTO CUS02 VALUES 
	(1, 'Ramesh', 32, 'Ahmedabad', 2000.00),
	(2, 'Khilan', 25, 'Delhi', 1500.00),
	(3, 'Kaushik', 23, 'Kota', 2000.00),
	(4, 'Chaitali', 25, 'Mumbai', 6500.00),
	(5, 'Hardik', 27, 'Bhopal', 8500.00),
	(6, 'Komal', 22, 'Hyderabad', 4500.00),
	(7, 'Muffy', 24, 'Indore', 10000.00);

	SELECT 
		S02F01,S02F02,S02F03,S02F04,S02F05
	FROM
		CUS02
	WHERE 
		S02F01 
	IN
		(SELECT S02F01 FROM CUS02 WHERE S02F05>3000)
	ORDER BY
		S02F02;

	SELECT 
		S02F01,S02F02,S02F03,S02F04,S02F05
	FROM
		CUS02
	WHERE EXISTS
		(SELECT S02F01 FROM CUS02 WHERE S02F05=15000);
        
	SELECT 
		S02F01,S02F02,S02F03,S02F04,S02F05
	FROM
		CUS02
	WHERE S02F05=ANY
		(SELECT S02F05 FROM CUS02 WHERE S02F05>4500);
        
	SELECT 
		S02F01,S02F02,S02F03,S02F04,S02F05
	FROM
		CUS02
	WHERE S02F05=ALL
		(SELECT S02F05 FROM CUS02 WHERE S02F05>3000);
        
-- SUBQUERY WITH THE INSERT
	CREATE TABLE  CUS03(
	   S03F01 INT NOT NULL PRIMARY KEY COMMENT 'CUSTOMER ID',
	   S03F02 VARCHAR(20) NOT NULL COMMENT 'CUSTOMER NAME',
	   S03F03 INT NOT NULL COMMENT 'CUSTOMER AGE',
	   S03F04 CHAR (25) COMMENT 'CUSTOMER ADDRESS',
	   S03F05 DECIMAL (18, 2) COMMENT 'CUSTOMER SALARY' 
	);
    
    INSERT INTO 
		CUS03
	SELECT 
		S02F01,S02F02,S02F03,S02F04,S02F05
	FROM
		CUS02
	WHERE 
		S02F01 
	IN
		(SELECT S02F01 FROM CUS02);
        
	SELECT 
		S03F01,S03F02,S03F03,S03F04,S03F05
	FROM
		CUS03;

-- SUBQUERY WITH THE UPDATE
	UPDATE 
		CUS02 
	SET
		S02F05 = S02F05*0.5
	WHERE 
		S02F03 
	IN
		(SELECT S03F03 FROM CUS03 WHERE S03F03 >= 27); 
        
	SELECT 
		S02F01,S02F02,S02F03,S02F04,S02F05
	FROM
		CUS02;
        
-- SUBQUERY WITH THE DELETE
	DELETE FROM
		CUS02
	WHERE 
		S02F03 
	IN
		(SELECT S03F03 FROM CUS03 WHERE S03F03 >= 27); 
        
	SELECT 
		S02F01,S02F02,S02F03,S02F04,S02F05
	FROM
		CUS02;


    

        
        
        

-- sakila
-- SELECT 
-- 	film_id,title,description
-- FROM
-- 	film
-- WHERE 
-- 	film_id IN (SELECT film_id FROM film_actor WHERE actor_id=1);